<?php include('header.php'); ?>
<?php include('navbar.php'); ?>

<?php
    mysql_connect("127.0.0.1", "root", "wso2123") or die("Error connecting to database: ".mysql_error());
   
     
    mysql_select_db("github2") or die(mysql_error());
    
?>
 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Search results</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<div class="col-lg-12" style="width: 100%" >
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div class="panel-heading"><i class="fa fa-edit"></i> Analysis on pull requests</div>
                    <div class="panel-body">
                                <div class="table-responsive">
                        <table class="table table-bordered " >
                         <thead style="border-bottom: 3px solid #c0c0c0;">
                          <tr>
                          <th class="active">Product</th>
                          <th class="active">Repository Name</th>
                          <th class="active">Repository URL</th> 
                          <th class="active">Pulls_ID</th> 
                          <th class="active">Pulls_url</th> 
                          <th class="active">No_of_open_hours</th>
                          <th class="active">No_of_open_days</th>
                          </tr>
                        </thead>
                        <tbody >
                                <?php
                                 include('navbar.php'); 
    $query = $_GET['query']; 
    
     
    $min_length = 3;
    
    if(strlen($query) >= $min_length){ 
         
        $query = htmlspecialchars($query); 
        
         
        $query = mysql_real_escape_string($query);
        
         
        $raw_results =  mysql_query("SELECT * FROM RetrieveTable
            WHERE (`RepoName` LIKE '%".$query."%') OR (`Product` LIKE '%".$query."%')") or die(mysql_error());
             
       
       
         
        if(mysql_num_rows($raw_results) > 0){
             
            while($results = mysql_fetch_array($raw_results)){
                echo "<tr>";
                            echo "<td>" . $results['Product'] . "</td>";
                            echo "<td>" . $results['RepoName'] . "</td>";
                            echo "<td>" . $results['RepoUrl'] . "</td>";
                            echo "<td>" . $results['PullsId'] . "</td>";
                            echo "<td>" . $results['PullsUrl'] . "</td>";
                            echo "<td>" . $results['NoOfHours'] . "</td>";
                            echo "<td>" . $results['OpenDays'] . "</td>";
                            echo "</tr>"; 
            
             
               
                
            }
             
        }
        else{ 
            echo "No results";
        }
         
    }
    else{ 
        echo "Minimum length is ".$min_length;
    }
?>
                        </tbody>
                          </table>
                    </div>
                    </div>
                </div>
            </div>
        </div><!--/.row-->                      
    </div>
<body>

</body>
</html>